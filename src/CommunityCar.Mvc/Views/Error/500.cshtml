@{
    ViewData["Title"] = ViewBag.Title ?? "Internal Server Error";
    ViewData["HideSidebars"] = true;
}
@using Microsoft.AspNetCore.Hosting
@inject IWebHostEnvironment Env

<div class="error-container">
    <div class="error-content">
        <div class="error-icon error-icon-danger">
            <i class="fas fa-server"></i>
        </div>
        <h1 class="error-code">500</h1>
        <h2 class="error-title">@ViewBag.Title</h2>
        <p class="error-message">@ViewBag.Message</p>
        
        <div class="error-actions">
            <a asp-controller="Feed" asp-action="Index" class="btn btn-primary">
                <i class="fas fa-home"></i> Go Home
            </a>
            <a href="javascript:location.reload()" class="btn btn-secondary">
                <i class="fas fa-redo"></i> Try Again
            </a>
        </div>

        @if (ViewBag.OriginalPath != null)
        {
            <p class="error-path">Requested path: <code>@ViewBag.OriginalPath</code></p>
        }

        @if (ViewBag.Exception != null && Env.IsDevelopment())
        {
            var ex = ViewBag.Exception as Exception;
            <div class="error-details">
                <div class="error-details-summary" onclick="toggleErrorDetails()">
                    <i class="fas fa-bug"></i>
                    <span>Developer Details</span>
                    <i class="fas fa-chevron-down ms-auto" id="detailsIcon"></i>
                </div>
                <div class="error-details-content d-none" id="detailsContent">
                    <span class="exception-message">@ex?.Message</span>
                    <div class="exception-stack-trace">@ex?.StackTrace</div>
                </div>
            </div>

            <script>
                function toggleErrorDetails() {
                    const content = document.getElementById('detailsContent');
                    const icon = document.getElementById('detailsIcon');
                    if (content.classList.contains('d-none')) {
                        content.classList.remove('d-none');
                        icon.classList.replace('fa-chevron-down', 'fa-chevron-up');
                    } else {
                        content.classList.add('d-none');
                        icon.classList.replace('fa-chevron-up', 'fa-chevron-down');
                    }
                }
            </script>
        }
    </div>
</div>
