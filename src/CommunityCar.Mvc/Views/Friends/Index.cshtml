@model IEnumerable<CommunityCar.Web.ViewModels.Community.FriendshipViewModel>
@{
    ViewData["Title"] = "My Friends";
}

<div class="row align-items-center mb-4">
    <div class="col-md-6">
        <h1 class="h3 mb-0">My Community</h1>
        <p class="text-muted">Stay connected with your fellow car enthusiasts.</p>
    </div>
    <div class="col-md-6 text-md-end">
        <a asp-action="Requests" class="btn btn-outline-primary position-relative me-2">
            Friend Requests
            @if (Model.Any(f => f.Status == CommunityCar.Domain.Enums.Community.friends.FriendshipStatus.Pending))
            {
                <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
                    @Model.Count(f => f.Status == CommunityCar.Domain.Enums.Community.friends.FriendshipStatus.Pending)
                </span>
            }
        </a>
        <button class="btn btn-primary"><i class="fas fa-search me-2"></i>Find Friends</button>
    </div>
</div>

<div class="card border-0 shadow-sm">
    <div class="card-body p-0">
        @if (!Model.Any())
        {
            <div class="text-center py-5">
                <i class="fas fa-user-friends fa-4x text-light mb-3"></i>
                <h5>No friends yet</h5>
                <p class="text-muted">Start by searching for members or inviting friends!</p>
                <button class="btn btn-primary mt-2">Find People</button>
            </div>
        }
        else
        {
            <div class="table-responsive">
                <table class="table table-hover align-middle mb-0">
                    <thead class="bg-light">
                        <tr>
                            <th class="ps-4 py-3">User</th>
                            <th class="py-3">Status</th>
                            <th class="py-3">Since</th>
                            <th class="text-end pe-4 py-3">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var friend in Model)
                        {
                            <tr>
                                <td class="ps-4">
                                    <div class="d-flex align-items-center gap-3">
                                        <div class="avatar-circle bg-primary text-white">
                                            @friend.FriendId.ToString()[..2].ToUpper()
                                        </div>
                                        <div>
                                            <p class="mb-0 fw-bold">User @friend.FriendId.ToString()[..8]</p>
                                            <span class="small text-muted">Active Member</span>
                                        </div>
                                    </div>
                                </td>
                                <td>
                                    <span class="badge bg-success-light text-success px-3">@friend.Status</span>
                                </td>
                                <td>
                                    @friend.Since.ToString("MMM dd, yyyy")
                                </td>
                                <td class="text-end pe-4">
                                    <button class="btn btn-sm btn-outline-secondary me-2">Message</button>
                                    <div class="btn-group">
                                        <button class="btn btn-sm btn-link text-dark dropdown-toggle no-caret" data-bs-toggle="dropdown">
                                            <i class="fas fa-ellipsis-v"></i>
                                        </button>
                                        <ul class="dropdown-menu dropdown-menu-end shadow border-0">
                                            <li><a class="dropdown-item" href="#"><i class="fas fa-user me-2"></i>View Profile</a></li>
                                            <li><hr class="dropdown-divider"></li>
                                            <li><a class="dropdown-item text-danger" href="#"><i class="fas fa-user-minus me-2"></i>Unfriend</a></li>
                                        </ul>
                                    </div>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        }
    </div>
</div>

<style>
    .avatar-circle { width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; }
    .bg-success-light { background: #e8f5e9; }
    .no-caret::after { display: none !important; }
</style>
